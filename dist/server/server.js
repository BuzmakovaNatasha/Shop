(()=>{var e={860:e=>{"use strict";e.exports=require("express")},147:e=>{"use strict";e.exports=require("fs")},17:e=>{"use strict";e.exports=require("path")}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{var e=n(860),t=n(147),r=e(),s=n(17);r.use(e.json()),r.use("/",e.static(s.resolve(__dirname,"../public"))),r.get("/api/products",(function(e,n){t.readFile(s.resolve(__dirname,"./db/products.json"),"utf-8",(function(e,t){e?n.send(JSON.stringify({result:0,text:e})):n.send(t)}))})),r.get("/api/catalog",(function(e,n){t.readFile(s.resolve(__dirname,"./db/products.json"),"utf-8",(function(e,t){e?n.send(JSON.stringify({result:0,text:e})):n.send(t)}))})),r.get("/api/catalogPageProduct",(function(e,n){t.readFile(s.resolve(__dirname,"./db/products.json"),"utf-8",(function(e,t){e?n.send(JSON.stringify({result:0,text:e})):n.send(t)}))})),r.get("/api/cart",(function(e,n){t.readFile(s.resolve(__dirname,"./db/userCart.json"),"utf-8",(function(e,t){e?n.sendStatus(404,JSON.stringify({result:0,text:e})):n.send(t)}))})),r.get("/api/product",(function(e,n){t.readFile(s.resolve(__dirname,"./db/productShow.json"),"utf-8",(function(e,t){e?n.send(JSON.stringify({result:0,text:e})):n.send(t)}))})),r.post("/api/product/show",(function(e,n){t.readFile(s.resolve(__dirname,"./db/productShow.json"),"utf-8",(function(r,i){if(r)n.sendStatus(404,JSON.stringify({result:0,text:r}));else{var u=JSON.parse(i);u.content=[e.body],t.writeFile(s.resolve(__dirname,"./db/productShow.json"),JSON.stringify(u),(function(e){e?n.send('{"result": 0}'):n.send('{"result": 1}')}))}}))})),r.post("/api/cart",(function(e,n){t.readFile(s.resolve(__dirname,"./db/userCart.json"),"utf-8",(function(r,i){if(r)n.sendStatus(404,JSON.stringify({result:0,text:r}));else{var u=JSON.parse(i);u.contents.push(e.body),t.writeFile(s.resolve(__dirname,"./db/userCart.json"),JSON.stringify(u),(function(e){e?n.send('{"result": 0}'):n.send('{"result": 1}')}))}}))})),r.put("/api/cart/add/:id",(function(e,n){t.readFile(s.resolve(__dirname,"./db/userCart.json"),"utf-8",(function(r,i){if(r)n.sendStatus(404,JSON.stringify({result:0,text:r}));else{var u=JSON.parse(i);u.contents.find((function(t){return t.id===+e.params.id})).quantity+=e.body.quantity,t.writeFile(s.resolve(__dirname,"./db/userCart.json"),JSON.stringify(u),(function(e){e?n.send('{"result": 0}'):n.send('{"result": 1}')}))}}))})),r.put("/api/cart/:id",(function(e,n){t.readFile(s.resolve(__dirname,"./db/userCart.json"),"utf-8",(function(r,i){if(r)n.sendStatus(404,JSON.stringify({result:0,text:r}));else{var u=JSON.parse(i),o=u.contents.find((function(t){return t.id===+e.params.id}));o.quantity<e.body.quantity?o.quantity+=1:o.quantity>e.body.quantity&&(o.quantity-=1),t.writeFile(s.resolve(__dirname,"./db/userCart.json"),JSON.stringify(u),(function(e){e?n.send('{"result": 0}'):n.send('{"result": 1}')}))}}))})),r.delete("/api/cart/:id",(function(e,n){t.readFile(s.resolve(__dirname,"./db/userCart.json"),"utf-8",(function(r,i){if(r)n.sendStatus(404,JSON.stringify({result:0,text:r}));else{var u=JSON.parse(i);if("clearcart"==e.params.id)u.contents=[];else{var o=u.contents.find((function(t){return t.id===+e.params.id}));u.contents.splice(u.contents.indexOf(o),1)}t.writeFile(s.resolve(__dirname,"./db/userCart.json"),JSON.stringify(u),(function(e){e?n.send('{"result": 0}'):n.send('{"result": 1}')}))}}))}));var i=process.env.PORT||3e3;r.listen(i,(function(){console.log("Listening ".concat(i," port"))}))})()})();